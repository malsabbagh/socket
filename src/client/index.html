
<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Demo sockets for a bug</title>
  </head>
<body>
  <h1>
    Web Socket
  </h1>
  <p>
    open console to see connection.
  </p>
  <script>
  var socket = new WebSocket("wss://socket-demo-webex.herokuapp.com/ws");

  socket.addEventListener("open", () => {
    // send a message to the server
    socket.send(JSON.stringify({
      type: "message from client",
      content: [ "socket request" ]
    }));
  });

  window.addEventListener("beforeunload", () => {
    socket.send(JSON.stringify({
      type: "close socket",
      content: [ "socket closed" ]
    }));
    socket.close( );
  });

  // receive a message from the server
  socket.addEventListener("message", ({ data }) => {
    const packet = JSON.parse(data);

    switch (packet.type) {
      case "message from server":
        console.log(packet.content);
        break;
    }
  });
  </script>
</body>
</html>